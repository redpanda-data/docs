= Audit Logging
:description: Learn how to use Redpanda's audit logging capabilities.

Many scenarios for streaming data include the need for fine-grained auditing of user activity related to the system. This is especially true for regulated industries such as finance, healthcare, and the public sector. Complying with PCI DSS v4 standards, for example, requires verbose and detailed activity auditing, alerting, and analysis capabilities.

Redpanda's auditing capabilities support recording both administrative and operational interactions with topics and with users. Redpanda complies with the Open Cybersecurity Schema Framework (OCSF), providing a predictable and extensible solution that works seamlessly with industry standard tools.

NOTE: All audit logging is configured at the cluster level. Redpanda supports excluding specific topics or principals from audit to help reduce noise in the log. Audit logging is disabled by default.

== Audit Log Flow

The Redpanda audit log mechanism functions similar to the Kafka flow you may be familiar with. When a user interacts with another user or with a topics, Redpanda writes an event to a specialized audit topic. The audit topic is immutable. Only Redpanda itself can write to it -- users are prevented from writing to the topic directly and the Kafka API cannot create or delete it.

image:shared:audit-loging-flow.png[Audit log flow]

By default, any management and authentication actions performed on the cluster yield messages written to the audit log topic that are retained for seven days. Interactions with all topics by all principals are audited. Actions performed using the Kafka API and Admin API are all audited, as are actions performed directly through rpk.

Messages recorded to the audit log topic comply with the https://schema.ocsf.io/[open cybersecurity schema framework]. Any number of analytics frameworks, such as Splunk or Sumo Logic, can receive and process these messages. Using an open standard ensures Redpanda's audit logs coexist with those produced by other IT assets, powering holistic monitoring and analysis of your assets.

== Audit Log Configuration Options

Redpanda's audit logging mechanism supports several options to control the volume and availability of audit records. Configuration is applied at the cluster level using the standard https://docs.redpanda.com/current/manage/cluster-maintenance/cluster-property-configuration/[cluster configuration mechanism]. The cluster configuration options exclusive to audit logging include the following:

* `audit_enabled` : Boolean value to enable audit logging (default: false)
* `audit_log_num_partitions` : Integer value defining the number of partitions used by the audit topic. This configuration is exclusive to the audit log topic. (default: null)
* `audit_enabled_event_types` : List of event types to include in the audit log. This may include any of the following - `management, produce, consume, describe, heartbeat, authenticate`. (default: `management,authenticate`)

Even though audited event messages are stored to a specialized immutable topic, standard topic settings still apply. For example, you can apply the same tiered storage, retention time, and replication settings available to normal topics. These particular options are important for controlling the amount of disk space utilized by your audit topics.

== Setting Audit Log Options

All audit log settings are applied at the cluster level using RPK. To configure them, open a terminal and execute `rpk cluster config edit`. Some options will require a cluster restart. This can be confirmed via `rpk cluster config status`.

Some key steps to tuning your audit logging settings using cluster configuration includes:

* Set `audit_enabled=true`.
* Choose the type of events needed by setting `audit_enabled_event_types` to the desired list of event categories.
* Assess the retention needs for your audit logs. You may not need to keep the logs around for the default seven days. This is controlled by setting `delete_retention_ms`.

== Optimizing Costs for Audit Logging

By default, audit logging is turned off. When enabled, audit logging can quickly generate a very large amount of data, especially if all event types are selected. Proper configuration of audit logging is critical for avoiding filling your disk or using excess tiered storage. The configuration options available help ensure your audit logs contain only the volume of data necessary to meeting your regulatory or legal requirements.

With audit logging, your own systems are producer and consumer for the messages. The pattern of message generation may be very different from your typical sources of data. As a result, your retention, replication, and tiered storage requirements may differ from your other topics.

A typical scenario with audit logging is to route the messages to an analytics platform like Splunk. If your retention period is excessively long, for example, you will find yourself storing excessive amounts of replicated messages in both Redpanda and in your analytics suite. Finding the right balance of retention and replication settings will minimize this duplication while retaining your data in a system where you can find actionable intelligence from it.