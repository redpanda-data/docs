// tag::single-source[]

Group-based access control (GBAC) builds on xref:manage:security/authorization/rbac.adoc[role-based access control (RBAC)] to simplify permission management at scale. Instead of assigning roles or ACLs to individual users, you assign them to OIDC groups managed by your identity provider (IdP). Users inherit permissions from all groups reported in their OIDC token claims, so onboarding and offboarding require no changes in Redpanda.

After reading this page, you will be able to:

* [ ] {learning-objective-1}
* [ ] {learning-objective-2}
* [ ] {learning-objective-3}

== How GBAC works

When a user authenticates with OIDC, Redpanda reads a configurable claim from the JWT access token (for example, `$.groups`) and extracts the list of groups the user belongs to. Redpanda then matches those group names against `Group:<name>` principals in its ACLs and role assignments.

Group membership is managed entirely by your IdP. Redpanda never stores or manages group membership directly. It reads group information from the OIDC token at authentication time.

GBAC works across all Redpanda APIs:

* Kafka API
* Admin API
* Schema Registry
* HTTP Proxy

=== Authorization patterns

GBAC supports two usage patterns:

Group assigned to a role:: Assign a group as a member of a role-based access control (RBAC) role. All users in the group inherit the role's ACLs.

Group as an ACL principal:: Create an ACL with a `Group:<name>` principal. Users in that group receive that permission directly.

Both patterns can be used together. When a user belongs to multiple groups, they inherit the combined permissions of all groups.

== Prerequisites

* xref:manage:security/authentication.adoc#oidc[OIDC authentication] must be configured and enabled on your cluster.
* Superuser access to configure cluster properties and manage ACLs.

ifndef::env-cloud[]
* You must have xref:get-started:licensing/overview.adoc[Enterprise Edition] license on your cluster.
endif::[]

== Assign groups to roles

Assigning a group to an RBAC role is the recommended pattern for managing permissions at scale. All users in the group inherit the role's ACLs automatically.

[tabs]
====
rpk::
+
--
To assign a group to a role:

[,bash]
----
rpk security role assign <role-name> --group <group-name>
----

For example, to assign the `engineering` group to the `DataEngineers` role:

[,bash]
----
rpk security role assign DataEngineers --group engineering
----

To remove a group from a role:

[,bash]
----
rpk security role unassign <role-name> --group <group-name>
----

For example:

[,bash]
----
rpk security role unassign DataEngineers --group engineering
----
--
{ui}::
+
--
include::manage:partial$gbac-assign-group-role.adoc[]
--
ifndef::env-cloud[]
Admin API::
+
--
These operations use the link:/api/doc/admin/v2/[Admin API v2] `SecurityService`. Send all requests as `POST` with a JSON body.

To assign a group to a role, call `AddRoleMembers`:

[,bash]
----
curl -u <user>:<password> \
  --request POST 'http://localhost:9644/redpanda.core.admin.v2.SecurityService/AddRoleMembers' \
  --header 'Content-Type: application/json' \
  --data '{
    "roleName": "DataEngineers",
    "members": [{"group": {"name": "engineering"}}]
  }'
----

To remove a group from a role, call `RemoveRoleMembers`:

[,bash]
----
curl -u <user>:<password> \
  --request POST 'http://localhost:9644/redpanda.core.admin.v2.SecurityService/RemoveRoleMembers' \
  --header 'Content-Type: application/json' \
  --data '{
    "roleName": "DataEngineers",
    "members": [{"group": {"name": "engineering"}}]
  }'
----
--
endif::[]
====

== Create group-based ACLs

You can grant permissions directly to a group by creating an ACL with a `Group:<name>` principal. This works the same as creating an ACL for a user, but uses the `Group:` prefix instead of `User:`.

[tabs]
====
rpk::
+
--
To grant cluster-level access to the `engineering` group:

[,bash]
----
rpk security acl create --allow-principal Group:engineering --operation describe --cluster
----

To grant topic-level access:

[,bash]
----
rpk security acl create \
  --allow-principal Group:engineering \
  --operation read,describe \
  --topic 'analytics-' \
  --resource-pattern-type prefixed
----

If your groups use path-style names (with `nested_group_behavior: none`), use the full path as the principal name:

[,bash]
----
rpk security acl create --allow-principal 'Group:/departments/eng/platform' --operation read --topic platform-data
----
--
{ui}::
+
--
include::manage:partial$gbac-create-group-acl.adoc[]
--
====

== View groups and roles

=== List groups assigned to a role

[tabs]
====
rpk::
+
--
To see which groups are assigned to a role, use `--print-groups`:

[,bash]
----
rpk security role describe <role-name> --print-groups
----

For example:

[,bash]
----
rpk security role describe DataEngineers --print-groups
----

To list all roles assigned to a specific group:

[,bash]
----
rpk security role list --group <group-name>
----

For example:

[,bash]
----
rpk security role list --group engineering
----
--
ifndef::env-cloud[]
Admin API::
+
--
These operations use the link:/api/doc/admin/v2/[Admin API v2] `SecurityService`. Send all requests as `POST` with a JSON body.

To retrieve a role's details including all members (users and groups), call `GetRole`:

[,bash]
----
curl -u <user>:<password> \
  --request POST 'http://localhost:9644/redpanda.core.admin.v2.SecurityService/GetRole' \
  --header 'Content-Type: application/json' \
  --data '{"name": "DataEngineers"}'
----

The response includes a `members` array with both `user` and `group` entries.

To list all roles, call `ListRoles`:

[,bash]
----
curl -u <user>:<password> \
  --request POST 'http://localhost:9644/redpanda.core.admin.v2.SecurityService/ListRoles' \
  --header 'Content-Type: application/json' \
  --data '{}'
----

To verify how Redpanda resolves groups from an OIDC token, call `ResolveOidcIdentity`. Pass the token in the `Authorization` header. The response includes the resolved `principal`, token expiry, and a `groups` field listing all groups extracted from the token:

[,bash]
----
curl \
  --request POST 'http://localhost:9644/redpanda.core.admin.v2.SecurityService/ResolveOidcIdentity' \
  --header 'Content-Type: application/json' \
  --header 'Authorization: Bearer <jwt-access-token>' \
  --data '{}'
----
--
endif::[]
====

== Supported identity providers

GBAC works with any OIDC-compliant identity provider. These providers are commonly used with Redpanda:

* https://auth0.com/docs/manage-users/groups[Auth0^]: Configure group claims in Auth0 Actions or Rules.
* https://developer.okta.com/docs/concepts/groups/[Okta^]: Assign groups to applications and include them in token claims.
* https://learn.microsoft.com/en-us/entra/identity/hybrid/connect/how-to-connect-fed-group-claims[Microsoft Entra ID (Azure AD)^]: Configure group claims in the application manifest.

For IdP-specific configuration steps, refer to your provider's documentation.

== Limitations

Azure AD group limit::
Users with more than 200 group memberships in Azure AD receive a URL reference in their token instead of a list of group names. Redpanda does not follow that URL and cannot resolve groups in this case. Mitigation: filter token claims to include only the groups relevant to Redpanda.

Nested groups::
Redpanda does not recursively resolve nested group hierarchies. If group A contains group B, only the direct memberships reported in the token are used. Use `nested_group_behavior: suffix` to extract the last path segment from hierarchical group names when needed.

No wildcard ACLs for groups::
ACL matching for `Group:` principals uses literal string comparison only. Wildcard patterns are not supported.

Deny ACL precedence::
When a user belongs to multiple groups with conflicting ACLs, deny rules take precedence over allow rules. This is consistent with standard Redpanda ACL conflict resolution.

Group membership timing::
Group membership reflects the claims in the OIDC token at authentication time. Changes made in the IdP (adding or removing group memberships) take effect at the user's next authentication, when a new token is issued.

== Customize token claim extraction

Different identity providers store group information in different locations within the JWT token. Two cluster properties control how Redpanda extracts group names:

xref:reference:properties/cluster-properties.adoc#oidc_group_claim_path[`oidc_group_claim_path`]:: A https://goessner.net/articles/JsonPath/[JSON path^] expression that tells Redpanda where to find group information in the OIDC token. For example, Auth0 and Okta typically use a top-level `groups` claim (`$.groups`), while Keycloak nests roles inside `realm_access` (`$.realm_access.roles`). Default: `$.groups`.

xref:reference:properties/cluster-properties.adoc#nested_group_behavior[`nested_group_behavior`]:: Controls how Redpanda handles group names that use path-style notation (for example, `/departments/eng/platform`). Set to `none` to use the full path as-is, or `suffix` to extract only the last segment. Default: `none`.

ifndef::env-cloud[]
To update these properties, use xref:manage:cluster-maintenance/cluster-property-configuration.adoc[any configuration method] (`rpk cluster config set`, the Admin API, or Redpanda Console). Changes take effect immediately without a restart.
endif::[]

ifdef::env-cloud[]
Contact Redpanda support to configure these properties on Cloud clusters.
endif::[]

=== Token structure examples

==== Flat group values (default)

[,json]
----
{"groups": ["engineering", "analytics"]}
----

With `oidc_group_claim_path: "$.groups"`, Redpanda resolves principals `Group:engineering` and `Group:analytics`.

==== Nested claim

[,json]
----
{"realm_access": {"roles": ["eng", "fin"]}}
----

With `oidc_group_claim_path: "$.realm_access.roles"`, Redpanda resolves principals `Group:eng` and `Group:fin`.

==== Path-style group names with suffix extraction

[,json]
----
{"groups": ["/departments/eng/platform", "/departments/eng/infra"]}
----

With `nested_group_behavior: "suffix"`, Redpanda resolves principals `Group:platform` and `Group:infra`.

==== CSV-formatted group claim

[,json]
----
{"groups": "engineering,analytics,finance"}
----

Redpanda automatically splits comma-separated values and resolves principals `Group:engineering`, `Group:analytics`, and `Group:finance`.

== Suggested reading

ifndef::env-cloud[]
* xref:manage:security/authorization/rbac.adoc[Role-Based Access Control (RBAC)]
* xref:manage:security/authorization/acl.adoc[Access Control Lists (ACLs)]
* xref:manage:security/authentication.adoc#oidc[OIDC Authentication]
endif::[]

ifdef::env-cloud[]
* xref:security:authorization/rbac/rbac_dp.adoc[Role-Based Access Control (RBAC)]
* xref:security:authorization/rbac/acl.adoc[Access Control Lists (ACLs)]
endif::[]

* xref:reference:rpk/rpk-security/rpk-security.adoc[`rpk security`]

// end::single-source[]
